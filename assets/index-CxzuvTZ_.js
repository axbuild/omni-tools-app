import{a as h,r as c,j as s,B as F,aB as v}from"./index-7JCrVMyd.js";import{T}from"./ToolContent-DrkA_-Xz.js";import{f as j,F as b}from"./index-on_GoYzL.js";import{T as y}from"./ToolVideoInput-D0Q1Ed0Y.js";import{T as d}from"./ToolFileResult-Div6pbTm.js";import{T as C}from"./TextFieldWithDesc-D98LnRRi.js";import{c as S,d as B}from"./index.esm-Cob4-rpC.js";import"./TextField-DeGHHacn.js";import"./objectWithoutProperties-rK072Nhf.js";import"./BaseFileInput-CTIURbfW.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-jIFHsyXN.js";import"./ResultFooter-DAeFmDVK.js";const l=new b;async function I(e,p){l.loaded||await l.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"});const o="input.mp4",a="output.mp4";await l.writeFile(o,await j(e));const t=[],i=p.loops-1;if(i<=0)return e;t.push("-stream_loop",i.toString()),t.push("-i",o),t.push("-c:v","libx264","-preset","ultrafast",a),await l.exec(t);const m=await l.readFile(a);return await new File([new Blob([m],{type:"video/mp4"})],`${e.name.replace(/\.[^/.]+$/,"")}_looped.mp4`,{type:"video/mp4"})}const L={loops:2},N=S({loops:B().min(1,"Number of loops must be greater than 1")});function J({title:e,longDescription:p}){const{t:o}=h("video"),[a,t]=c.useState(null),[i,m]=c.useState(null),[x,f]=c.useState(!1),w=async(u,r)=>{if(r)try{f(!0);const n=await I(r,u);await m(n)}catch(n){console.error(n)}finally{f(!1)}},g=({values:u,updateField:r})=>[{title:o("loop.loops"),component:s.jsx(F,{children:s.jsx(C,{onOwnChange:n=>v(n,"loops",r),value:u.loops,label:o("loop.numberOfLoops")})})}];return s.jsx(T,{title:e,input:a,inputComponent:s.jsx(y,{value:a,onChange:t}),resultComponent:x?s.jsx(d,{value:null,title:o("loop.loopingVideo"),loading:!0,extension:""}):s.jsx(d,{value:i,title:o("loop.resultTitle"),extension:"mp4"}),initialValues:L,validationSchema:N,getGroups:g,setInput:t,compute:w,toolInfo:{title:o("loop.toolInfo.title",{title:e}),description:p}})}export{J as default};
