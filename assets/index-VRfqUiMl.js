import{r,j as o,B as S}from"./index-7JCrVMyd.js";import{T as V}from"./ToolContent-DrkA_-Xz.js";import{T as $}from"./ToolVideoInput-D0Q1Ed0Y.js";import{T as h}from"./ToolFileResult-Div6pbTm.js";import{S as n}from"./SimpleRadio-BbIGpl0h.js";import{f as R,F as I}from"./index-on_GoYzL.js";import"./TextField-DeGHHacn.js";import"./objectWithoutProperties-rK072Nhf.js";import"./BaseFileInput-CTIURbfW.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-jIFHsyXN.js";import"./ResultFooter-DAeFmDVK.js";import"./Radio-Clz2uSlr.js";import"./SwitchBase-CZaFkbti.js";const L={quality:"mid",fps:"10",scale:"320:-1:flags=bicubic"};function X({title:c,longDescription:y}){const[f,m]=r.useState(null),[d,j]=r.useState(null),[v,p]=r.useState(!1),C=(i,t)=>{if(!t)return;const{fps:T,scale:b}=i;let e=null,u=!1;(async(g,x,w)=>{p(!0),e||(e=new I),u||(await e.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"}),u=!0);const l=g.name,s="output.gif";try{e.writeFile(l,await R(g)),await e.exec(["-i",l,"-vf",`fps=${x},scale=${w},palettegen`,"palette.png"]),await e.exec(["-i",l,"-i","palette.png","-filter_complex",`fps=${x},scale=${w}[x];[x][1:v]paletteuse`,s]);const a=await e.readFile(s),k=new Blob([a],{type:"image/gif"}),G=new File([k],s,{type:"image/gif"});await e.deleteFile(l),await e.deleteFile(s),j(G)}catch(a){throw console.error(`Failed to convert video: ${a}`),a}finally{p(!1)}})(t,T,b)},q=({values:i,updateField:t})=>[{title:"Set Quality",component:o.jsxs(S,{children:[o.jsx(n,{title:"Low",onClick:()=>{t("quality","low"),t("fps","5"),t("scale","240:-1:flags=bilinear")},checked:i.quality==="low"}),o.jsx(n,{title:"Mid",onClick:()=>{t("quality","mid"),t("fps","10"),t("scale","320:-1:flags=bicubic")},checked:i.quality==="mid"}),o.jsx(n,{title:"High",onClick:()=>{t("quality","high"),t("fps","15"),t("scale","480:-1:flags=lanczos")},checked:i.quality==="high"}),o.jsx(n,{title:"Ultra",onClick:()=>{t("quality","ultra"),t("fps","15"),t("scale","640:-1:flags=lanczos")},checked:i.quality==="ultra"})]})}];return o.jsx(V,{title:c,input:f,inputComponent:o.jsx($,{value:f,onChange:m,title:"Input Video"}),resultComponent:v?o.jsx(h,{title:"Converting to Gif",value:null,loading:!0}):o.jsx(h,{title:"Converted to Gif",value:d,extension:"gif"}),initialValues:L,getGroups:q,setInput:m,compute:C,toolInfo:{title:`What is a ${c}?`,description:y}})}export{X as default};
