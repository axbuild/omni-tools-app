import{a as C,r,J as j,j as s,B as c,aB as g,T as d}from"./index-7JCrVMyd.js";import{i as F}from"./browser-image-compression-BzWLnoYn.js";import{T as I}from"./ToolContent-DrkA_-Xz.js";import{T as q}from"./ToolImageInput-BfRmeQE8.js";import{T as w}from"./ToolFileResult-Div6pbTm.js";import{T as y}from"./TextFieldWithDesc-D98LnRRi.js";import"./TextField-DeGHHacn.js";import"./BaseFileInput-CTIURbfW.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-jIFHsyXN.js";import"./ResultFooter-DAeFmDVK.js";const M=async(n,e)=>{try{const{maxFileSizeInMB:o,quality:a}=e,p={maxSizeMB:o,maxWidthOrHeight:1920,useWebWorker:!0,initialQuality:a/100},m=await F(n,p);return new File([m],n.name,{type:m.type})}catch(o){return console.error("Error compressing image:",o),null}},O={maxFileSizeInMB:1,quality:80};function Q({title:n}){const{t:e}=C("image"),[o,a]=r.useState(null),[p,m]=r.useState(null),[z,u]=r.useState(!1),[x,h]=r.useState(null),[S,f]=r.useState(null),{showSnackBar:T}=r.useContext(j),B=async(l,i)=>{if(i){h(i.size);try{u(!0);const t=await M(i,l);t?(m(t),f(t.size)):T(e("compress.failedToCompress"),"error")}catch(t){console.error("Error in compression:",t)}finally{u(!1)}}};return s.jsx(I,{title:n,input:o,inputComponent:s.jsx(q,{value:o,onChange:a,accept:["image/*"],title:e("compress.inputTitle")}),resultComponent:s.jsx(w,{title:e("compress.resultTitle"),value:p,loading:z}),initialValues:O,getGroups:({values:l,updateField:i})=>[{title:e("compress.compressionOptions"),component:s.jsxs(c,{children:[s.jsx(y,{name:"maxFileSizeInMB",type:"number",inputProps:{min:.1,step:.1},description:e("compress.maxFileSizeDescription"),onOwnChange:t=>g(t,"maxFileSizeInMB",i),value:l.maxFileSizeInMB}),s.jsx(y,{name:"quality",type:"number",inputProps:{min:10,max:100,step:1},description:e("compress.qualityDescription"),onOwnChange:t=>g(t,"quality",i),value:l.quality})]})},{title:e("compress.fileSizes"),component:s.jsx(c,{children:s.jsxs(c,{children:[x!==null&&s.jsxs(d,{children:[e("compress.originalSize"),":"," ",(x/1024).toFixed(2)," KB"]}),S!==null&&s.jsxs(d,{children:[e("compress.compressedSize"),":"," ",(S/1024).toFixed(2)," KB"]})]})})}],compute:B,setInput:a})}export{Q as default};
