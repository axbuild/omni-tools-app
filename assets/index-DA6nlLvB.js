import{a as F,r as T,j as o,B as w}from"./index-7JCrVMyd.js";import{T as j}from"./ToolContent-DrkA_-Xz.js";import{T as h}from"./ToolAudioInput-yQIa9QyJ.js";import{T as x}from"./ToolFileResult-Div6pbTm.js";import{T as v}from"./TextFieldWithDesc-D98LnRRi.js";import{f as b,F as C}from"./index-on_GoYzL.js";import{R as y}from"./RadioGroup-C6kaQY45.js";import{F as R}from"./FormControlLabel-Bkvpm43S.js";import{R as A}from"./Radio-Clz2uSlr.js";import"./TextField-DeGHHacn.js";import"./BaseFileInput-CTIURbfW.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-jIFHsyXN.js";import"./ResultFooter-DAeFmDVK.js";import"./FormGroup-DuLNvNQv.js";import"./SwitchBase-CZaFkbti.js";const c=new C;async function $(p,f){c.loaded||await c.load({wasmURL:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.9/dist/esm/ffmpeg-core.wasm"});const t="input.mp3";await c.writeFile(t,await b(p));const{startTime:a,endTime:r,outputFormat:i}=f,m=`output.${i}`;let s=["-i",t,"-ss",a,"-to",r,"-c","copy"];i==="mp3"?s=["-i",t,"-ss",a,"-to",r,"-ar","44100","-ac","2","-b:a","192k","-f","mp3",m]:i==="aac"?s=["-i",t,"-ss",a,"-to",r,"-c:a","aac","-b:a","192k","-f","adts",m]:i==="wav"&&(s=["-i",t,"-ss",a,"-to",r,"-acodec","pcm_s16le","-ar","44100","-ac","2","-f","wav",m]),await c.exec(s);const d=await c.readFile(m);let n="audio/mp3";return i==="aac"&&(n="audio/aac"),i==="wav"&&(n="audio/wav"),new File([new Blob([d],{type:n})],`${p.name.replace(/\.[^/.]+$/,"")}_trimmed.${i}`,{type:n})}const I={startTime:"00:00:00",endTime:"00:01:00",outputFormat:"mp3"},S=[{label:"MP3",value:"mp3"},{label:"AAC",value:"aac"},{label:"WAV",value:"wav"}];function K({title:p,longDescription:f}){const{t}=F("audio"),[a,r]=T.useState(null),[i,m]=T.useState(null),[s,d]=T.useState(!1),n=async(u,l)=>{if(l){d(!0);try{const e=await $(l,u);m(e)}catch(e){console.error(`Failed to trim audio: ${e}`),m(null)}finally{d(!1)}}},g=({values:u,updateField:l})=>[{title:t("trim.timeSettings"),component:o.jsxs(w,{children:[o.jsx(v,{value:u.startTime,onOwnChange:e=>l("startTime",e),description:t("trim.startTimeDescription"),label:t("trim.startTime")}),o.jsx(w,{mt:2,children:o.jsx(v,{value:u.endTime,onOwnChange:e=>l("endTime",e),description:t("trim.endTimeDescription"),label:t("trim.endTime")})})]})},{title:t("trim.outputFormat"),component:o.jsx(w,{mt:2,children:o.jsx(y,{row:!0,value:u.outputFormat,onChange:e=>l("outputFormat",e.target.value),children:S.map(e=>o.jsx(R,{value:e.value,control:o.jsx(A,{}),label:e.label},e.value))})})}];return o.jsx(j,{title:p,input:a,inputComponent:o.jsx(h,{value:a,onChange:r,title:t("trim.inputTitle")}),resultComponent:s?o.jsx(x,{title:t("trim.trimmingAudio"),value:null,loading:!0}):o.jsx(x,{title:t("trim.resultTitle"),value:i,extension:i?i.name.split(".").pop():void 0}),initialValues:I,getGroups:g,setInput:r,compute:n,toolInfo:{title:t("trim.toolInfo.title",{title:p}),description:f}})}export{K as default};
