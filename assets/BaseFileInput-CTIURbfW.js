import{a as R,r as c,d as P,W as U,J as B,j as o,B as g,ao as O,T as D}from"./index-7JCrVMyd.js";import{I as T}from"./ContentPaste-CJSvfBhK.js";import{I as A}from"./InputFooter-Cia2zmGJ.js";import{g as W}from"./grey-pattern-DMflWW5d.js";import{l as $}from"./lodash-jIFHsyXN.js";const N=t=>{const a=Math.floor(t/60),l=Math.floor(t%60);return`${a.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`},H=t=>URL.createObjectURL(t),M=t=>{URL.revokeObjectURL(t)};function Q({value:t,onChange:a,accept:l,title:w,children:k,type:p}){const{t:d}=R(),[h,x]=c.useState(null),[f,m]=c.useState(!1),n=P(),y=U.useRef(null),{showSnackBar:b}=c.useContext(B);c.useEffect(()=>{if(t)try{const e=H(t);return x(e),()=>M(e)}catch(e){console.error("Error previewing file:",e)}else x(null)},[t]);const v=e=>{var i;const r=(i=e.target.files)==null?void 0:i[0];r&&a(r)},I=()=>{var e;(e=y.current)==null||e.click()},C=()=>{if($.isArray(t)){const e=new Blob([t[0]],{type:t[0].type}),r=new ClipboardItem({[t[0].type]:e});navigator.clipboard.write([r]).then(()=>b(d("baseFileInput.fileCopied"),"success")).catch(i=>{b(d("baseFileInput.copyFailed",{error:i}),"error")})}},F=e=>{if(e.preventDefault(),e.stopPropagation(),m(!1),e.dataTransfer.files&&e.dataTransfer.files.length>0){const r=e.dataTransfer.files[0];l.some(s=>{if(s.endsWith("/*")){const u=s.split("/")[0];return r.type.startsWith(u)}return s===r.type})?a(r):b(`Invalid file type. Please use ${l.join(", ")}`,"error")}},S=e=>{e.preventDefault(),e.stopPropagation()},E=e=>{e.preventDefault(),e.stopPropagation(),m(!0)},L=e=>{e.preventDefault(),e.stopPropagation(),m(!1)};return c.useEffect(()=>{const e=r=>{var u;const s=(((u=r.clipboardData)==null?void 0:u.items)??[])[0];if(s&&(s.type.includes("image")||s.type.includes("video"))){const j=s.getAsFile();j&&a(j)}};return window.addEventListener("paste",e),()=>{window.removeEventListener("paste",e)}},[a]),o.jsxs(g,{children:[o.jsx(T,{title:w||"Input "+p.charAt(0).toUpperCase()+p.slice(1)}),o.jsx(g,{sx:{width:"100%",height:O,border:h?0:1,borderRadius:2,boxShadow:"5",bgcolor:"background.paper",position:"relative",borderColor:f?n.palette.primary.main:void 0,borderWidth:f?2:1,borderStyle:f?"dashed":"solid"},onDrop:F,onDragOver:S,onDragEnter:E,onDragLeave:L,children:h?o.jsx(g,{width:"100%",height:"100%",sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundImage:n.palette.mode==="dark"?null:`url(${W})`,position:"relative",overflow:"hidden"},children:k({preview:h})}):o.jsx(g,{onClick:I,sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:5,height:"100%",cursor:"pointer"},children:f?o.jsx(D,{color:n.palette.primary.main,variant:"h6",align:"center",children:d("baseFileInput.dropFileHere",{type:p})}):o.jsx(D,{color:n.palette.mode==="dark"?n.palette.grey[300]:n.palette.grey[600],children:d("baseFileInput.selectFileDescription",{type:p})})})}),o.jsx(A,{handleCopy:C,handleImport:I}),o.jsx("input",{ref:y,style:{display:"none"},type:"file",accept:l.join(","),onChange:v,multiple:!1})]})}export{Q as B,N as f};
