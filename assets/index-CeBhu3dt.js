import{a as T,r as m,j as h,B as R,P as v,T as p}from"./index-7JCrVMyd.js";import{T as U}from"./ToolContent-DrkA_-Xz.js";import{T as L}from"./ToolTextInput-pMJPolT7.js";import{T as S}from"./ToolTextResult-BPpE0Rrg.js";import{A as b}from"./Alert-Bmk1WzvB.js";import"./TextField-DeGHHacn.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./ResultFooter-DAeFmDVK.js";import"./index-Bb8_02NB.js";import"./Close-DxdBQUtL.js";const D=[{char:"‚ÄÆ",name:"Right-to-Left Override",unicode:"U+202E"},{char:"‚Ä≠",name:"Left-to-Right Override",unicode:"U+202D"},{char:"‚Ä´",name:"Right-to-Left Embedding",unicode:"U+202B"},{char:"‚Ä™",name:"Left-to-Right Embedding",unicode:"U+202A"},{char:"‚Äè",name:"Right-to-Left Mark",unicode:"U+200F"},{char:"‚Äé",name:"Left-to-Right Mark",unicode:"U+200E"}],I=[{char:"‚Äã",name:"Zero Width Space",unicode:"U+200B"},{char:"‚Äå",name:"Zero Width Non-Joiner",unicode:"U+200C"},{char:"‚Äç",name:"Zero Width Joiner",unicode:"U+200D"},{char:"‚Å†",name:"Word Joiner",unicode:"U+2060"},{char:"\uFEFF",name:"Zero Width No-Break Space",unicode:"U+FEFF"},{char:"¬†",name:"Non-Breaking Space",unicode:"U+00A0"},{char:"‚ÄÄ",name:"En Quad",unicode:"U+2000"},{char:"‚ÄÅ",name:"Em Quad",unicode:"U+2001"},{char:"‚ÄÇ",name:"En Space",unicode:"U+2002"},{char:"‚ÄÉ",name:"Em Space",unicode:"U+2003"},{char:"‚ÄÑ",name:"Three-Per-Em Space",unicode:"U+2004"},{char:"‚ÄÖ",name:"Four-Per-Em Space",unicode:"U+2005"},{char:"‚ÄÜ",name:"Six-Per-Em Space",unicode:"U+2006"},{char:"‚Äá",name:"Figure Space",unicode:"U+2007"},{char:"‚Äà",name:"Punctuation Space",unicode:"U+2008"},{char:"‚Äâ",name:"Thin Space",unicode:"U+2009"},{char:"‚Ää",name:"Hair Space",unicode:"U+200A"}];function W(r,i){const e=`U+${r.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")}`,o=D.find(u=>u.char===r);if(o)return{char:r,unicode:o.unicode,name:o.name,category:"RTL Override",position:i,isRTL:!0,isInvisible:!1,isZeroWidth:!1};const s=I.find(u=>u.char===r);return s?{char:r,unicode:s.unicode,name:s.name,category:"Invisible Character",position:i,isRTL:!1,isInvisible:!0,isZeroWidth:r==="‚Äã"||r==="‚Äå"||r==="‚Äç"||r==="‚Å†"||r==="\uFEFF"}:r.charCodeAt(0)<32||r.charCodeAt(0)===127?{char:r,unicode:e,name:`Control Character (${r.charCodeAt(0)})`,category:"Control Character",position:i,isRTL:!1,isInvisible:!0,isZeroWidth:!1}:{char:r,unicode:e,name:"Regular Character",category:"Regular",position:i,isRTL:!1,isInvisible:!1,isZeroWidth:!1}}function E(r,i){const e=[];for(let t=0;t<r.length;t++){const a=r[t],c=W(a,t);(i.highlightRTL&&c.isRTL||i.showInvisibleChars&&c.isInvisible||i.includeZeroWidthChars&&c.isZeroWidth)&&e.push(c)}const o=e.some(t=>t.isRTL),s=e.some(t=>t.isInvisible),u=e.some(t=>t.isZeroWidth);return{originalText:r,hiddenCharacters:e,hasRTLOverride:o,hasInvisibleChars:s,hasZeroWidthChars:u,totalHiddenChars:e.length}}const $={showUnicodeCodes:!0,highlightRTL:!0,showInvisibleChars:!0,includeZeroWidthChars:!0};function w({title:r,longDescription:i}){const{t:e}=T("string"),[o,s]=m.useState(""),[u,t]=m.useState(""),[a,c]=m.useState(null),g=(C,f)=>{if(f.trim())try{const l=E(f,C);if(c(l),l.totalHiddenChars===0)t(e("hiddenCharacterDetector.noHiddenChars"));else{let n=e("hiddenCharacterDetector.foundChars",{count:l.totalHiddenChars});l.hiddenCharacters.forEach(d=>{n+=`${e("hiddenCharacterDetector.position")} ${d.position}: ${d.name} (${d.unicode})
`,C.showUnicodeCodes&&(n+=`  ${e("hiddenCharacterDetector.unicode")}: ${d.unicode}
`),n+=`  ${e("hiddenCharacterDetector.category")}: ${d.category}
`,d.isRTL&&(n+=`  ‚ö†Ô∏è  ${e("hiddenCharacterDetector.rtlOverride")}
`),d.isInvisible&&(n+=`  üëÅÔ∏è  ${e("hiddenCharacterDetector.invisibleChar")}
`),d.isZeroWidth&&(n+=`  üìè  ${e("hiddenCharacterDetector.zeroWidthChar")}
`),n+=`
`}),l.hasRTLOverride&&(n+=`‚ö†Ô∏è  ${e("hiddenCharacterDetector.rtlWarning")}
`),t(n)}}catch(l){t(`Error: ${l}`)}};return h.jsx(U,{title:r,inputComponent:h.jsxs(R,{children:[h.jsx(L,{value:o,onChange:s,title:e("hiddenCharacterDetector.inputTitle"),placeholder:e("hiddenCharacterDetector.inputPlaceholder")}),a&&a.hasRTLOverride&&h.jsx(b,{severity:"warning",sx:{mt:2},children:e("hiddenCharacterDetector.rtlAlert")}),a&&a.totalHiddenChars>0&&h.jsxs(v,{sx:{p:2,mt:2,backgroundColor:"#fff3cd"},children:[h.jsx(p,{variant:"h6",gutterBottom:!0,children:e("hiddenCharacterDetector.summary")}),h.jsxs(p,{variant:"body2",children:[e("hiddenCharacterDetector.totalChars",{count:a.totalHiddenChars}),a.hasRTLOverride&&` ‚Ä¢ ${e("hiddenCharacterDetector.rtlFound")}`,a.hasInvisibleChars&&` ‚Ä¢ ${e("hiddenCharacterDetector.invisibleFound")}`,a.hasZeroWidthChars&&` ‚Ä¢ ${e("hiddenCharacterDetector.zeroWidthFound")}`]})]})]}),resultComponent:h.jsx(S,{value:u}),initialValues:$,getGroups:null,compute:g,input:o,setInput:s,toolInfo:{title:`What is ${r}?`,description:i||"A tool to detect hidden Unicode characters, especially RTL Override characters that could be used in attacks."}})}export{w as default};
