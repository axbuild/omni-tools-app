import{r as P,j as e,B as y}from"./index-7JCrVMyd.js";import{c as L,d as u}from"./index.esm-Cob4-rpC.js";import{T as M}from"./ToolImageInput-BfRmeQE8.js";import{T as U}from"./ToolFileResult-Div6pbTm.js";import{T as g}from"./TextFieldWithDesc-D98LnRRi.js";import{T as $}from"./ToolContent-DrkA_-Xz.js";import{S}from"./SimpleRadio-BbIGpl0h.js";import"./BaseFileInput-CTIURbfW.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-jIFHsyXN.js";import"./ResultFooter-DAeFmDVK.js";import"./TextField-DeGHHacn.js";import"./Radio-Clz2uSlr.js";import"./SwitchBase-CZaFkbti.js";const D={xPosition:"0",yPosition:"0",cropWidth:"100",cropHeight:"100",cropShape:"rectangular"},G=L({xPosition:u().min(0,"X position must be positive").required("X position is required"),yPosition:u().min(0,"Y position must be positive").required("Y position is required"),cropWidth:u().min(1,"Width must be at least 1px").required("Width is required"),cropHeight:u().min(1,"Height must be at least 1px").required("Height is required")});function ct({title:f}){const[l,w]=P.useState(null),[j,b]=P.useState(null),W=(t,o)=>{if(!o)return;const{xPosition:i,yPosition:a,cropWidth:R,cropHeight:O,cropShape:v}=t,k=parseInt(i),E=parseInt(a),Y=parseInt(R),B=parseInt(O);(async(c,x,C,r,n,X)=>{const d=document.createElement("canvas"),I=d.getContext("2d");if(I==null)return;const m=document.createElement("canvas"),s=m.getContext("2d");if(s==null)return;const p=new Image;if(p.src=URL.createObjectURL(c),await p.decode(),d.width=p.width,d.height=p.height,I.drawImage(p,0,0),m.width=r,m.height=n,X){s.beginPath();const h=Math.min(r,n)/2;s.arc(r/2,n/2,h,0,Math.PI*2),s.closePath(),s.clip(),s.drawImage(p,x,C,r,n,0,0,r,n)}else s.drawImage(p,x,C,r,n,0,0,r,n);m.toBlob(h=>{if(h){const z=new File([h],c.name,{type:c.type});b(z)}},c.type)})(o,k,E,Y,B,v==="circular")},H=(t,o)=>(i,a)=>{o("xPosition",i.x.toString()),o("yPosition",i.y.toString()),o("cropWidth",a.width.toString()),o("cropHeight",a.height.toString())},T=({values:t,updateField:o})=>[{title:"Crop Position and Size",component:e.jsxs(y,{children:[e.jsx(g,{value:t.xPosition,onOwnChange:i=>o("xPosition",i),description:"X position (in pixels)",inputProps:{"data-testid":"x-position-input",type:"number",min:0}}),e.jsx(g,{value:t.yPosition,onOwnChange:i=>o("yPosition",i),description:"Y position (in pixels)",inputProps:{"data-testid":"y-position-input",type:"number",min:0}}),e.jsx(g,{value:t.cropWidth,onOwnChange:i=>o("cropWidth",i),description:"Crop width (in pixels)",inputProps:{"data-testid":"crop-width-input",type:"number",min:1}}),e.jsx(g,{value:t.cropHeight,onOwnChange:i=>o("cropHeight",i),description:"Crop height (in pixels)",inputProps:{"data-testid":"crop-height-input",type:"number",min:1}})]})},{title:"Crop Shape",component:e.jsxs(y,{children:[e.jsx(S,{onClick:()=>o("cropShape","rectangular"),checked:t.cropShape=="rectangular",description:"Crop a rectangular fragment from an image.",title:"Rectangular Crop Shape"}),e.jsx(S,{onClick:()=>o("cropShape","circular"),checked:t.cropShape=="circular",description:"Crop a circular fragment from an image.",title:"Circular Crop Shape"})]})}],q=(t,o)=>e.jsx(M,{value:l,onChange:w,accept:["image/*"],title:"Input image",showCropOverlay:!!l,cropShape:t.cropShape,cropPosition:{x:parseInt(t.xPosition||"0"),y:parseInt(t.yPosition||"0")},cropSize:{width:parseInt(t.cropWidth||"100"),height:parseInt(t.cropHeight||"100")},onCropChange:H(t,o)});return e.jsx($,{title:f,initialValues:D,getGroups:T,compute:W,input:l,validationSchema:G,renderCustomInput:q,resultComponent:e.jsx(U,{title:"Cropped image",value:j}),toolInfo:{title:"Crop Image",description:"This tool allows you to crop an image by specifying the position, size, and shape of the crop area. You can choose between rectangular or circular cropping."}})}export{ct as default};
