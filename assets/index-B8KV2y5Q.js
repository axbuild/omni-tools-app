import{a as b,r as n,J as z,j as o,B as d,T as l}from"./index-7JCrVMyd.js";import{T as D}from"./ToolContent-DrkA_-Xz.js";import{c as R,l as B}from"./utils-C6ykel4o.js";import{T as F}from"./ToolPdfInput-CYdTNe9U.js";import{T as L}from"./ToolFileResult-Div6pbTm.js";import{S as E}from"./SimpleRadio-BbIGpl0h.js";import{P as I}from"./PDFButton-BHQNOqBC.js";import"./TextField-DeGHHacn.js";import"./BaseFileInput-CTIURbfW.js";import"./ContentPaste-CJSvfBhK.js";import"./InputFooter-Cia2zmGJ.js";import"./grey-pattern-DMflWW5d.js";import"./lodash-jIFHsyXN.js";import"./ResultFooter-DAeFmDVK.js";import"./Radio-Clz2uSlr.js";import"./SwitchBase-CZaFkbti.js";async function k(c,f){if(c.type!=="application/pdf")throw new Error("The provided file is not a PDF");const s={psDataURL:URL.createObjectURL(c),compressionLevel:f.compressionLevel},t=await R(s);return await B(t,c.name)}const M={compressionLevel:"low"};function _({title:c,longDescription:f}){const{t:s}=b("pdf"),[t,u]=n.useState(null),[j,g]=n.useState(null),[P,C]=n.useState(""),[S,h]=n.useState(!1),[p,m]=n.useState(null),{showSnackBar:x}=n.useContext(z);n.useEffect(()=>{(async()=>{if(!t){m(null);return}try{const r=await t.arrayBuffer(),a=(await I.load(r)).getPageCount(),T=v(t.size);m({size:T,pages:a})}catch(r){console.error("Error getting PDF info:",r),m(null),x(s("compressPdf.errorReadingPdf"),"error")}})()},[t]);const v=i=>{if(i===0)return"0 Bytes";const r=1024,e=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(i)/Math.log(r));return parseFloat((i/Math.pow(r,a)).toFixed(2))+" "+e[a]},y=async(i,r)=>{if(r)try{h(!0);const e=await k(r,i);g(e);const a=e.size/r.size*100;console.log(`Compression Ratio: ${a.toFixed(2)}%`),C(v(e.size))}catch(e){console.error("Error compressing PDF:",e),x(s("compressPdf.errorCompressingPdf",{error:e instanceof Error?e.message:String(e)}),"error"),g(null)}finally{h(!1)}},w=[{value:"low",label:s("compressPdf.lowCompression"),description:s("compressPdf.lowCompressionDescription")},{value:"medium",label:s("compressPdf.mediumCompression"),description:s("compressPdf.mediumCompressionDescription")},{value:"high",label:s("compressPdf.highCompression"),description:s("compressPdf.highCompressionDescription")}];return o.jsx(D,{title:c,input:t,setInput:u,initialValues:M,compute:y,inputComponent:o.jsx(F,{value:t,onChange:u,accept:["application/pdf"],title:s("compressPdf.inputTitle")}),resultComponent:o.jsx(L,{title:s("compressPdf.resultTitle"),value:j,extension:"pdf",loading:S,loadingText:s("compressPdf.compressingPdf")}),getGroups:({values:i,updateField:r})=>[{title:s("compressPdf.compressionSettings"),component:o.jsxs(d,{children:[o.jsxs(d,{children:[o.jsx(l,{variant:"subtitle2",sx:{mb:1},children:s("compressPdf.compressionLevel")}),w.map(e=>o.jsx(E,{title:e.label,description:e.description,checked:i.compressionLevel===e.value,onClick:()=>{r("compressionLevel",e.value)}},e.value))]}),p&&o.jsxs(d,{sx:{mt:2,p:2,bgcolor:"background.paper",borderRadius:1},children:[o.jsxs(l,{variant:"body2",children:[s("compressPdf.fileSize"),":"," ",o.jsx("strong",{children:p.size})]}),o.jsxs(l,{variant:"body2",children:[s("compressPdf.pages"),": ",o.jsx("strong",{children:p.pages})]}),P&&o.jsxs(l,{variant:"body2",children:[s("compressPdf.compressedFileSize"),":"," ",o.jsx("strong",{children:P})]})]})]})}]})}export{_ as default};
